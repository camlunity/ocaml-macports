# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem   1.0

name		 tuareg-mode.el
epoch		 1
version		 2.0.4

categories   lang editors
#maintainers  nomaintainer

description  A GNU Emacs/XEmacs major mode for editing Caml and OCaml programs.
long_description\
    Tuareg is a Caml mode for GNU Emacs  and XEmacs. It handles \
    automatic indentation of Objective Caml and Camllight codes. \
    Key parts of the code are highlighted using Font-Lock. Support \
    to run an interactive Caml toplevel and debugger is provided.

homepage     http://tuareg.forge.ocamlcore.org/
platforms    darwin
distname     tuareg-${version}
master_sites http://forge.ocamlcore.org/frs/download.php/514/

checksums    md5     6bd7cd7305d5f1d084af4ff5982db964 \
             sha1    4b8c0812771df036378a028d798b5396d6542a0a \
             rmd160  9ea738210316ac9dd1903d3937fc961ae8277e24

# We want emacs from MacPorts since this will install stuff in emacs'
# site-lisp and we want it to go into ${prefix}'s site-lisp.
depends_lib  port:emacs
depends_run  port:ocaml

use_configure       no
universal_variant   no

build {
    system "cd ${worksrcpath} && \
        emacs --batch --eval \
            '(progn (setq load-path (cons \".\" load-path)) \
                (byte-compile-file \"tuareg.el\") \
                (byte-compile-file \"camldebug.el\"))'"
}

destroot {
    file mkdir ${destroot}${prefix}/share/emacs/site-lisp
    xinstall ${worksrcpath}/tuareg.el ${destroot}${prefix}/share/emacs/site-lisp/
    xinstall ${worksrcpath}/tuareg.elc ${destroot}${prefix}/share/emacs/site-lisp/
    xinstall ${worksrcpath}/camldebug.el ${destroot}${prefix}/share/emacs/site-lisp/
    xinstall ${worksrcpath}/camldebug.elc ${destroot}${prefix}/share/emacs/site-lisp/
    xinstall ${worksrcpath}/sym-lock.el ${destroot}${prefix}/share/emacs/site-lisp/
}

post-install {
    ui_msg "To use this, put the following into your ~/.emacs:"
    ui_msg "(setq auto-mode-alist"
    ui_msg "  (cons '(\"\\\\.ml\\\\w?\" . tuareg-mode) auto-mode-alist))"
    ui_msg "(autoload 'tuareg-mode \"tuareg\" \"Major mode for editing Caml code.\" t)"
    ui_msg "(autoload 'camldebug \"cameldeb\" \"Run the Caml debugger.\" t)"
}

livecheck.type  regex
livecheck.regex {var last_version = "Tuareg Version (.*)";}
